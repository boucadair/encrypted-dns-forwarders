<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Hosting Encrypted DNS Forwarders on CPEs</title>
<meta content="Tirumaleswar Reddy" name="author">
<meta content="Mohamed Boucadair" name="author">
<meta content="Dan Wing" name="author">
<meta content="
       Typical connectivity service offerings based upon on Customer Premise Equipment (CPEs)
involve DNS forwarders on the CPE for various reasons (offer
local services, control the scope/content of information in DNS, ensure better
dependability for local service, provide control to users, etc.). Upgrading DNS to use
encrypted transports introduces deployment complications as to how to sustain current
offerings with local services. Solutions are needed to ease operating
DNS forwarders in CPEs while allowing to make use of encrypted DNS  capabilities. 
       This document describes the problem and to what extent existing solutions can or can't be used for
these deployments. For example, Star certificates and name constraints extension suffer from
the problem of deploying a new feature to CAs, TLS clients, and servers. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="DNS" name="keyword">
<meta content="deployment" name="keyword">
<meta content="Discovery" name="keyword">
<meta content="draft-rbw-add-encrypted-dns-forwarders-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 69.5.1
    wcwidth 0.2.13
-->
<link href="draft-rbw-add-encrypted-dns-forwarders.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Encrypted DNS Forwarders on CPEs</td>
<td class="right">August 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Reddy, et al.</td>
<td class="center">Expires 16 February 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Adaptive DNS Discovery</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-rbw-add-encrypted-dns-forwarders-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-08-15" class="published">15 August 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-02-16">16 February 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">M. Boucadair</div>
<div class="org">Orange</div>
</div>
<div class="author">
      <div class="author-name">D. Wing</div>
<div class="org">Cloud Software Group</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Hosting Encrypted DNS Forwarders on CPEs</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Typical connectivity service offerings based upon on Customer Premise Equipment (CPEs)
involve DNS forwarders on the CPE for various reasons (offer
local services, control the scope/content of information in DNS, ensure better
dependability for local service, provide control to users, etc.). Upgrading DNS to use
encrypted transports introduces deployment complications as to how to sustain current
offerings with local services. Solutions are needed to ease operating
DNS forwarders in CPEs while allowing to make use of encrypted DNS  capabilities.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document describes the problem and to what extent existing solutions can or can't be used for
these deployments. For example, Star certificates and name constraints extension suffer from
the problem of deploying a new feature to CAs, TLS clients, and servers.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Adaptive DNS Discovery Working Group mailing list (add@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/add/">https://mailarchive.ietf.org/arch/browse/add/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/boucadair/encrypted-dns-forwarders">https://github.com/boucadair/encrypted-dns-forwarders</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 16 February 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-proxied-dns-in-local-networ" class="internal xref">Proxied DNS In Local Networks</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-hosting-encrypted-dns-forwa" class="internal xref">Hosting Encrypted DNS Forwarder in Local Networks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-discovery-of-designated-res" class="internal xref">Discovery of Designated Resolvers (DDR)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-discovery-of-network-design" class="internal xref">Discovery of Network-designated Resolvers (DNR)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-certificate-issuance-issues" class="internal xref">Certificate Issuance Issues</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-requirements" class="internal xref">Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-non-requirements" class="internal xref">Non-Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-analysis-of-solutions-to-re" class="internal xref">Analysis of Solutions to Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normal-certificates" class="internal xref">Normal Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-delegated-credentials" class="internal xref">Delegated Credentials</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-name-constraints" class="internal xref">Name Constraints</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-acme-delegated-certificates" class="internal xref">ACME Delegated Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-raw-public-keys" class="internal xref">Raw Public Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-self-signed-certificate" class="internal xref">Self-signed Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-local-ca-certification-auth" class="internal xref">Local CA: Certification Authority Built Into CPE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-example-of-delegated-certif" class="internal xref">Example of Delegated Certificate Issuance</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Customer Premises Equipment (CPEs, also called Home Routers) are a
   critical component of the home network, and their security is
   essential to protecting the devices and data that are connected to
   them.  For example, the prpl Foundation <span>[<a href="#prpl" class="cite xref">prpl</a>]</span> has developed a number
   of initiatives to promote home router security and hardening.  The
   prplWrt project <span>[<a href="#prplwrt" class="cite xref">prplwrt</a>]</span> is an initiative in prpl Foundation that
   aims to improve the security and performance of open-source router
   firmware, such as OpenWrt <span>[<a href="#openwrt" class="cite xref">openwrt</a>]</span>.  OpenWrt is an open-source
   operating system that is designed to run on a wide range of routers
   and embedded devices.  It now includes support for containerization
   technology such as Docker, making it possible to run containerized
   applications on a home router.  Further, DNS providers have optimized
   the encrypted DNS forwarder to run in a container in home routers.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">However, upgrading DNS to use encrypted transports (e.g., DNS over HTTPS (DoH) <span>[<a href="#RFC8484" class="cite xref">RFC8484</a>]</span>, DNS over TLS (DoT) <span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span>,
   and DNS over QUIC (DoQ) <span>[<a href="#RFC9250" class="cite xref">RFC9250</a>]</span>) introduces deployment complications as to how to sustain current
offerings with local services.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document describes the problem encountered to host encrypted DNS resolvers
   in managed CPEs. It also identifies a set of requirements and discusses to what extent existing solutions
   can (or can't) meet these requirements.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The scope of this document is encrypted DNS servers deployed on managed CPEs.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The document does not focus on generic considerations related to deploying DNS proxies. The reader may
refer to <span>[<a href="#RFC5625" class="cite xref">RFC5625</a>]</span> for such matters.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">This document makes use of the terms defined in <span>[<a href="#RFC9499" class="cite xref">RFC9499</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The following additional terms are used:<a href="#section-2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">DHCP:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.2">
          <p id="section-2-3.2.1">refers to both DHCPv4 and DHCPv6.<a href="#section-2-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">Do53:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.4">
          <p id="section-2-3.4.1">refers to unencrypted DNS.<a href="#section-2-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">DNR:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.6">
          <p id="section-2-3.6.1">refers to the Discovery of Network-designated Resolvers
procedure defined in <span>[<a href="#RFC9463" class="cite xref">RFC9463</a>]</span>.<a href="#section-2-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">DDR:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.8">
          <p id="section-2-3.8.1">refers to the Discovery of Designated Resolvers procedure
defined in <span>[<a href="#RFC9462" class="cite xref">RFC9462</a>]</span>.<a href="#section-2-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">Encrypted DNS:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.10">
          <p id="section-2-3.10.1">refers to a scheme where DNS exchanges are
transported over an encrypted channel.  Examples of encrypted DNS
are DoH <span>[<a href="#RFC8484" class="cite xref">RFC8484</a>]</span>, DoT <span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span>, and DoQ <span>[<a href="#RFC9250" class="cite xref">RFC9250</a>]</span>.<a href="#section-2-3.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">Managed CPE:</dt>
        <dd style="margin-left: 1.5em" id="section-2-3.12">
          <p id="section-2-3.12.1">refers to a CPE that is managed by an ISP or CPE vendor
or Security Service Provider.<a href="#section-2-3.12.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="proxied-dns-in-local-networks">
<section id="section-3">
      <h2 id="name-proxied-dns-in-local-networ">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-proxied-dns-in-local-networ" class="section-name selfRef">Proxied DNS In Local Networks</a>
      </h2>
<p id="section-3-1"><a href="#fig1" class="auto internal xref">Figure 1</a> shows various network setups where the CPE embeds a caching
   encrypted DNS forwarder.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-proxied-encrypted-dns-sessi"></span><div id="fig1">
<figure id="figure-1">
        <div id="section-3-2.1">
          <div class="alignLeft art-svg artwork" id="section-3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="384" width="560" viewBox="0 0 560 384" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 48,272 L 48,352" fill="none" stroke="black"></path>
              <path d="M 80,96 L 80,176" fill="none" stroke="black"></path>
              <path d="M 88,240 L 88,272" fill="none" stroke="black"></path>
              <path d="M 120,64 L 120,96" fill="none" stroke="black"></path>
              <path d="M 224,272 L 224,352" fill="none" stroke="black"></path>
              <path d="M 256,96 L 256,176" fill="none" stroke="black"></path>
              <path d="M 288,240 L 288,320" fill="none" stroke="black"></path>
              <path d="M 320,64 L 320,144" fill="none" stroke="black"></path>
              <path d="M 400,104 L 400,176" fill="none" stroke="black"></path>
              <path d="M 408,240 L 408,272" fill="none" stroke="black"></path>
              <path d="M 448,64 L 448,80" fill="none" stroke="black"></path>
              <path d="M 480,272 L 480,352" fill="none" stroke="black"></path>
              <path d="M 136,48 L 240,48" fill="none" stroke="black"></path>
              <path d="M 336,48 L 432,48" fill="none" stroke="black"></path>
              <path d="M 96,80 L 112,80" fill="none" stroke="black"></path>
              <path d="M 272,80 L 312,80" fill="none" stroke="black"></path>
              <path d="M 336,96 L 432,96" fill="none" stroke="black"></path>
              <path d="M 136,112 L 240,112" fill="none" stroke="black"></path>
              <path d="M 88,142 L 152,142" fill="none" stroke="black"></path>
              <path d="M 88,146 L 152,146" fill="none" stroke="black"></path>
              <path d="M 184,142 L 248,142" fill="none" stroke="black"></path>
              <path d="M 184,146 L 248,146" fill="none" stroke="black"></path>
              <path d="M 88,158 L 112,158" fill="none" stroke="black"></path>
              <path d="M 88,162 L 112,162" fill="none" stroke="black"></path>
              <path d="M 224,158 L 248,158" fill="none" stroke="black"></path>
              <path d="M 224,162 L 248,162" fill="none" stroke="black"></path>
              <path d="M 104,224 L 208,224" fill="none" stroke="black"></path>
              <path d="M 304,224 L 392,224" fill="none" stroke="black"></path>
              <path d="M 64,256 L 80,256" fill="none" stroke="black"></path>
              <path d="M 240,256 L 280,256" fill="none" stroke="black"></path>
              <path d="M 416,256 L 456,256" fill="none" stroke="black"></path>
              <path d="M 104,288 L 208,288" fill="none" stroke="black"></path>
              <path d="M 304,288 L 392,288" fill="none" stroke="black"></path>
              <path d="M 56,318 L 120,318" fill="none" stroke="black"></path>
              <path d="M 56,322 L 120,322" fill="none" stroke="black"></path>
              <path d="M 152,318 L 216,318" fill="none" stroke="black"></path>
              <path d="M 152,322 L 216,322" fill="none" stroke="black"></path>
              <path d="M 56,334 L 80,334" fill="none" stroke="black"></path>
              <path d="M 56,338 L 80,338" fill="none" stroke="black"></path>
              <path d="M 192,334 L 216,334" fill="none" stroke="black"></path>
              <path d="M 192,338 L 216,338" fill="none" stroke="black"></path>
              <path d="M 232,334 L 296,334" fill="none" stroke="black"></path>
              <path d="M 232,338 L 296,338" fill="none" stroke="black"></path>
              <path d="M 408,334 L 472,334" fill="none" stroke="black"></path>
              <path d="M 408,338 L 472,338" fill="none" stroke="black"></path>
              <path d="M 136,48 C 127.16936,48 120,55.16936 120,64" fill="none" stroke="black"></path>
              <path d="M 240,48 C 248.83064,48 256,55.16936 256,64" fill="none" stroke="black"></path>
              <path d="M 336,48 C 327.16936,48 320,55.16936 320,64" fill="none" stroke="black"></path>
              <path d="M 432,48 C 440.83064,48 448,55.16936 448,64" fill="none" stroke="black"></path>
              <path d="M 336,96 C 327.16936,96 320,88.83064 320,80" fill="none" stroke="black"></path>
              <path d="M 432,96 C 440.83064,96 448,88.83064 448,80" fill="none" stroke="black"></path>
              <path d="M 136,112 C 127.16936,112 120,104.83064 120,96" fill="none" stroke="black"></path>
              <path d="M 240,112 C 248.83064,112 256,104.83064 256,96" fill="none" stroke="black"></path>
              <path d="M 104,224 C 95.16936,224 88,231.16936 88,240" fill="none" stroke="black"></path>
              <path d="M 208,224 C 216.83064,224 224,231.16936 224,240" fill="none" stroke="black"></path>
              <path d="M 304,224 C 295.16936,224 288,231.16936 288,240" fill="none" stroke="black"></path>
              <path d="M 392,224 C 400.83064,224 408,231.16936 408,240" fill="none" stroke="black"></path>
              <path d="M 104,288 C 95.16936,288 88,280.83064 88,272" fill="none" stroke="black"></path>
              <path d="M 208,288 C 216.83064,288 224,280.83064 224,272" fill="none" stroke="black"></path>
              <path d="M 304,288 C 295.16936,288 288,280.83064 288,272" fill="none" stroke="black"></path>
              <path d="M 392,288 C 400.83064,288 408,280.83064 408,272" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="480,336 468,330.4 468,341.6" fill="black" transform="rotate(0,472,336)"></polygon>
              <polygon class="arrowhead" points="256,160 244,154.4 244,165.6" fill="black" transform="rotate(0,248,160)"></polygon>
              <polygon class="arrowhead" points="256,144 244,138.4 244,149.6" fill="black" transform="rotate(0,248,144)"></polygon>
              <polygon class="arrowhead" points="240,336 228,330.4 228,341.6" fill="black" transform="rotate(180,232,336)"></polygon>
              <polygon class="arrowhead" points="224,336 212,330.4 212,341.6" fill="black" transform="rotate(0,216,336)"></polygon>
              <polygon class="arrowhead" points="224,320 212,314.4 212,325.6" fill="black" transform="rotate(0,216,320)"></polygon>
              <polygon class="arrowhead" points="96,160 84,154.4 84,165.6" fill="black" transform="rotate(180,88,160)"></polygon>
              <polygon class="arrowhead" points="96,144 84,138.4 84,149.6" fill="black" transform="rotate(180,88,144)"></polygon>
              <polygon class="arrowhead" points="64,336 52,330.4 52,341.6" fill="black" transform="rotate(180,56,336)"></polygon>
              <polygon class="arrowhead" points="64,320 52,314.4 52,325.6" fill="black" transform="rotate(180,56,320)"></polygon>
              <g class="text">
                <text x="16" y="36">(a)</text>
                <text x="384" y="68">ISP</text>
                <text x="76" y="84">Host</text>
                <text x="184" y="84">LAN</text>
                <text x="256" y="84">CPE</text>
                <text x="352" y="84">DNS</text>
                <text x="404" y="84">Resolver</text>
                <text x="288" y="132">&lt;=DNR=&gt;</text>
                <text x="168" y="148">DNR</text>
                <text x="152" y="164">Encrypted</text>
                <text x="208" y="164">DNS</text>
                <text x="304" y="164">&lt;=Encrypted</text>
                <text x="376" y="164">DNS=&gt;</text>
                <text x="16" y="212">(b)</text>
                <text x="472" y="244">3rd</text>
                <text x="512" y="244">Party</text>
                <text x="44" y="260">Host</text>
                <text x="152" y="260">LAN</text>
                <text x="224" y="260">CPE</text>
                <text x="352" y="260">ISP</text>
                <text x="472" y="260">DNS</text>
                <text x="524" y="260">Resolver</text>
                <text x="256" y="308">&lt;=DNR=&gt;</text>
                <text x="136" y="324">DNR</text>
                <text x="120" y="340">Encrypted</text>
                <text x="176" y="340">DNS</text>
                <text x="336" y="340">Encrypted</text>
                <text x="392" y="340">DNS</text>
              </g>
            </svg><a href="#section-3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-proxied-encrypted-dns-sessi" class="selfRef">Proxied Encrypted DNS Sessions</a>
        </figcaption></figure>
</div>
<p id="section-3-3">For all the cases shown in <a href="#fig1" class="auto internal xref">Figure 1</a>, the CPE advertises itself as the
   default DNS server to the hosts it serves in the LAN.  The CPE relies
   upon DHCP or RA to advertise itself to internal hosts as the default
   encrypted DNS forwarder using DNR. When receiving a DNS request that a CPE cannot
   handle locally, the CPE forwards the request to an upstream encrypted
   DNS. The upstream encrypted DNS can be hosted by the ISP or provided
   by a third party.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Such a forwarder presence is required for (but not limuted to):<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">
          <p id="section-3-5.1.1">IPv4 service continuity purposes (e.g., <span><a href="https://rfc-editor.org/rfc/rfc8585#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8585" class="cite xref">RFC8585</a>]</span>).<a href="#section-3-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-5.2">
          <p id="section-3-5.2.1">Supporting advanced services within a local network such as:<a href="#section-3-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.2.2.1">
              <p id="section-3-5.2.2.1.1">malware filtering,<a href="#section-3-5.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-5.2.2.2">
              <p id="section-3-5.2.2.2.1">parental control,<a href="#section-3-5.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-5.2.2.3">
              <p id="section-3-5.2.2.3.1">Manufacturer Usage Description (MUD) <span>[<a href="#RFC8520" class="cite xref">RFC8520</a>]</span> to only allow
 intended communications to and from an IoT device, and<a href="#section-3-5.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-5.2.2.4">
              <p id="section-3-5.2.2.4.1">offer multicast DNS proxy service for the ".local" domain <span>[<a href="#RFC6762" class="cite xref">RFC6762</a>]</span>.<a href="#section-3-5.2.2.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-3-6">When the CPE behaves as a DNS forwarder, DNS communications can be decomposed into
   two legs to resolve queries:<a href="#section-3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-7.1">
          <p id="section-3-7.1.1">The leg between an internal host and the CPE.<a href="#section-3-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-7.2">
          <p id="section-3-7.2.1">The leg between the CPE and an upstream DNS resolver.<a href="#section-3-7.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="hosting-encrypted-dns-forwarder-in-local-networks">
<section id="section-4">
      <h2 id="name-hosting-encrypted-dns-forwa">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-hosting-encrypted-dns-forwa" class="section-name selfRef">Hosting Encrypted DNS Forwarder in Local Networks</a>
      </h2>
<p id="section-4-1">This section discusses some deployment challenges to host an
   encrypted DNS forwarder within a local network.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="discovery-of-designated-resolvers-ddr">
<section id="section-4.1">
        <h3 id="name-discovery-of-designated-res">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-discovery-of-designated-res" class="section-name selfRef">Discovery of Designated Resolvers (DDR)</a>
        </h3>
<p id="section-4.1-1">DDR requires proving possession of an IP address, as the DDR
   certificate contains the server's IPv4 and IPv6 addresses and is
   signed by a Certification Authority (CA).  DDR is constrained to public IP
   addresses because (WebPKI) CAs will not sign
   special-purpose IP addresses <span>[<a href="#RFC6890" class="cite xref">RFC6890</a>]</span>, most notably IPv4 private-use
   <span>[<a href="#RFC1918" class="cite xref">RFC1918</a>]</span>, IPv4 shared address <span>[<a href="#RFC6598" class="cite xref">RFC6598</a>]</span>, or IPv6 Unique-Local
   <span>[<a href="#RFC8190" class="cite xref">RFC8190</a>]</span> address space.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">A tempting solution for enabling an encrypted DNS forwarder with DDR is to use the CPE's WAN
   IP address for DDR and prove possession of that IP address.  However,
   the CPE's WAN IPv4 address will not be a public IPv4 address if the
   CPE is behind another layer of NAT (either Carrier Grade NAT (CGN) or
   another on-premise NAT), reducing the success of this mechanism to
   CPE's WAN IPv6 address.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Also, if the ISP renumbers the subscriber's
   network suddenly (rather than slow IPv6 renumbering described in
   <span>[<a href="#RFC4192" class="cite xref">RFC4192</a>]</span>), encrypted DNS service will be delayed until that new
   certificate is acquired.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discovery-of-network-designated-resolvers-dnr">
<section id="section-4.2">
        <h3 id="name-discovery-of-network-design">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-discovery-of-network-design" class="section-name selfRef">Discovery of Network-designated Resolvers (DNR)</a>
        </h3>
<p id="section-4.2-1">DNR requires proving possession of a domain name as the encrypted
   resolver's certificate contains the FQDN. For example, the entity (e.g., ISP or
   network administrator) managing the CPE would assign a unique FQDN to
   the CPE. There are two mechanisms for the CPE to obtain the
   certificate for the FQDN: using one of its WAN IP addresses or
   requesting its signed certificate from an Internet-facing server used
   for remote CPE management (e.g., the Auto Configuration Server (ACS)
   in the CPE WAN Management Protocol <span>[<a href="#TR-069" class="cite xref">TR-069</a>]</span>).<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">If the CPE's WAN IP address is used, the CPE needs a public IPv4 or a global unicast IPv6
   address together with DNS A or AAAA records pointing to that CPE's
   WAN address to prove possession of the DNS name to obtain a (WebPKI)
   CA-signed certificate. That is, the CPE fulfills the DNS or HTTP
   challenge discussed in Automatic Certificate Management Environment (ACME) <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>.  However, a CPE's WAN address
   will not be a public IPv4 address if the CPE is behind another layer
   of NAT (either a CGN or another on-premise NAT), reducing the success
   of this mechanism to a CPE's WAN IPv6 address. If the ISP renumbers the subscriber's
   network, the DNS record will also need to expire and changed to
   reflect the new IP address.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-issuance-issues">
<section id="section-4.3">
        <h3 id="name-certificate-issuance-issues">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-certificate-issuance-issues" class="section-name selfRef">Certificate Issuance Issues</a>
        </h3>
<p id="section-4.3-1">The following lists some limitations for certificate issuance:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">
            <p id="section-4.3-2.1.1">In case of large scale of CPEs (e.g., millions of devices),
issuing certificate request for a large number of subdomains could
be treated as an attack by the certificate authorities to
overwhelm it.<a href="#section-4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.2">
            <p id="section-4.3-2.2.1">Dependency on the CA to issue a large number of certificates.<a href="#section-4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.3">
            <p id="section-4.3-2.3.1">If the CPE uses one of its WAN IP addresses to obtain the
certificate for the FQDN, the Internet-facing HTTP server or a DNS
authoritative server on the CPE to complete the HTTP or DNS
challenge can be subjected to DDoS attacks.<a href="#section-4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="requirements">
<section id="section-5">
      <h2 id="name-requirements">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-5-1">
        <dt id="section-5-1.1">R-REDUCE-CA:</dt>
        <dd style="margin-left: 1.5em" id="section-5-1.2">
          <p id="section-5-1.2.1">Reduce the use of a Certification Authority for each CPE, compared
to obtaining and renewing one certificate for each CPE from a (public)
Certification Authority.<a href="#section-5-1.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-5-1.3">R-ELIMINATE-CA:</dt>
        <dd style="margin-left: 1.5em" id="section-5-1.4">
          <p id="section-5-1.4.1">Eliminate using Certification Authorities for each CPE.<a href="#section-5-1.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-5-1.5">R-SUPPORT-CA:</dt>
        <dd style="margin-left: 1.5em" id="section-5-1.6">
          <p id="section-5-1.6.1">Existing support by Certification Authorities.<a href="#section-5-1.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-5-1.7">R-SUPPORT-CLIENT:</dt>
        <dd style="margin-left: 1.5em" id="section-5-1.8">
          <p id="section-5-1.8.1">Existing support client libraries or client software intances.<a href="#section-5-1.8.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="non-requirements">
<section id="section-6">
      <h2 id="name-non-requirements">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-non-requirements" class="section-name selfRef">Non-Requirements</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-6-1">
        <dt id="section-6-1.1">NR-REVOKE:</dt>
        <dd style="margin-left: 1.5em" id="section-6-1.2">
          <p id="section-6-1.2.1">Provide mechanism to revoke certificates. End users are
extremely unlikely to contact the device vendor or their ISP if a CPE
device is replaced (stolen, upgraded, etc.).  Rather, the user will replace
the CPE and configure their client devices (laptops, smartphones, IoT
devices, etc.) to authorize the new CPE.<a href="#section-6-1.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-1.3"></dt>
        <dd style="margin-left: 1.5em" id="section-6-1.4">
          <p id="section-6-1.4.1">As part of that configuration, the
client device might refuse to authorize the previous CPE.<a href="#section-6-1.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-1.5"></dt>
        <dd style="margin-left: 1.5em" id="section-6-1.6">
          <p id="section-6-1.6.1">While this
does leave the client devices open to attack by the previous (stolen)
CPE, the attacker would also need to have access to the victim's
physical network or broadcast a strong enough Wi-Fi signal to the
victim's clients.<a href="#section-6-1.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="analysis-of-solutions-to-requirements">
<section id="section-7">
      <h2 id="name-analysis-of-solutions-to-re">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-analysis-of-solutions-to-re" class="section-name selfRef">Analysis of Solutions to Requirements</a>
      </h2>
<p id="section-7-1">This section describes several solutions which can meet some of the requirements.  This is first summarized in <a href="#table1" class="auto internal xref">Table 1</a> and
detailed in the following subsections.<a href="#section-7-1" class="pilcrow">¶</a></p>
<span id="name-summary-of-solution-analysi"></span><div id="table1">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-summary-of-solution-analysi" class="selfRef">Summary of Solution Analysis</a>
        </caption>
<thead>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">Solution</th>
            <th class="text-center" rowspan="1" colspan="1">Reduce CA</th>
            <th class="text-center" rowspan="1" colspan="1">Eliminate CA</th>
            <th class="text-center" rowspan="1" colspan="1">Existing CA Support</th>
            <th class="text-center" rowspan="1" colspan="1">Existing Client Support</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">Normal certificates</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">Delegated credentials</td>
            <td class="text-center" rowspan="1" colspan="1">Yes, somewhat</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">No, (*)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">Name constraints</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">ACME delegated certificates</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">Raw Public Keys</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
            <td class="text-center" rowspan="1" colspan="1">n/a</td>
            <td class="text-center" rowspan="1" colspan="1">Some, (*)</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">Self-Signed Certificate</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
            <td class="text-center" rowspan="1" colspan="1">n/a</td>
            <td class="text-center" rowspan="1" colspan="1">Yes, poor experience</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">Local Certificate Authority</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">No</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
            <td class="text-center" rowspan="1" colspan="1">Yes</td>
          </tr>
        </tbody>
      </table>
</div>
<div id="normal-certificates">
<section id="section-7.1">
        <h3 id="name-normal-certificates">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normal-certificates" class="section-name selfRef">Normal Certificates</a>
        </h3>
<p id="section-7.1-1">This solution has the CPE requests a (cloud) server to obtain a certificate
for the CPE from a public CA. This solution is deployed in production
by Mozilla <span>[<a href="#https-local-dom" class="cite xref">https-local-dom</a>]</span>, McAfee, and Cujo.  Today, this is best
practice.  However, it suffers from the dependency on both the public
Certification Authority and the vendor's service (necessary because the
CPE cannot always obtain a publicly-accessible IPv4 address necessary
to get an ACME-signed certificate itself), which are necessary
for both initial deployment and for certificate renewal.  One standard for
such a system is <span>[<a href="#PKIX-EST" class="cite xref">PKIX-EST</a>]</span>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">R-REDUCE-CA: no<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">R-ELIMINATE-CA: no<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">Both CAs and clients already support the normal mode of operation.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">R-SUPPORT-CA: yes<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">R-SUPPORT-CLIENT: yes<a href="#section-7.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delegated">
<section id="section-7.2">
        <h3 id="name-delegated-credentials">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-delegated-credentials" class="section-name selfRef">Delegated Credentials</a>
        </h3>
<p id="section-7.2-1">Delegated credentials <span>[<a href="#RFC9345" class="cite xref">RFC9345</a>]</span> allows the entity operating the CPE
(e.g., vendor or ISP) to sign a 7-day validity for the CPE's public key.
The frequency of CA interactions remains the same as with normal
certificates (<a href="#normal-certificates" class="auto internal xref">Section 7.1</a>), but the interactions are with
the vendor's service rather than the public CA.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">As currently specified in <span>[<a href="#RFC9345" class="cite xref">RFC9345</a>]</span>, the same name would be issued to all CPEs
making it impossible to identify whether the delegated credential is
issued to the intended CPE or an "evil-twin" CPE. This drawback can be corrected
by enhancing <span>[<a href="#RFC9345" class="cite xref">RFC9345</a>]</span> to include a string that uniquely identifies the
delegated credential (e.g., including hash of customer id or other unique identifier
in the FQDN such as "HASH.cpe.example.com").<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.2-3.1">
            <p id="section-7.2-3.1.1">For the sake of simplifying the analysis, this document assumes such an
enhancement to <span>[<a href="#RFC9345" class="cite xref">RFC9345</a>]</span> has been standardized and deployed.<a href="#section-7.2-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-4">R-REDUCE-CA: yes, somewhat by moving CA signing from public CA to a
vendor- or ISP-operated service.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">R-ELIMINATE-CA: no<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">Delegated credentials have no existing support by CAs. Clients need to
support <span><a href="https://rfc-editor.org/rfc/rfc9345#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC9345" class="cite xref">RFC9345</a>]</span> which requires sending an
extension in their TLS 1.3 ClientHello.  The only client supporting
delegated credentials is Firefox.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<p id="section-7.2-7">R-SUPPORT-CA: no<a href="#section-7.2-7" class="pilcrow">¶</a></p>
<p id="section-7.2-8">R-SUPPORT-CLIENT: no, only supported by Firefox<a href="#section-7.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="name-constraints">
<section id="section-7.3">
        <h3 id="name-name-constraints">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-name-constraints" class="section-name selfRef">Name Constraints</a>
        </h3>
<p id="section-7.3-1">Name constraints (<span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.10" class="relref">Section 4.2.1.10</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) allows the entity
operating the CPE (e.g., vendor or ISP) to obtain a certificate from a
public Certification Authority for a subdomain (dNSName) which is then
used to sign certificates for each CPE.  For example, the network "example.net"
could obtain a name constrained certificate for ".cpe.example.net" and then
issue its own certificates such as "customer-123.cpe.example.net".<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">R-REDUCE-CA: yes, it reduces interaction with public CAs but has same
number of interactions with the CPE operator's CA.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">R-ELIMINATE-CA: no<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">Name constraints have no existing support by CAs or by clients.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">R-SUPPORT-CA: no<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<p id="section-7.3-6">R-SUPPORT-CLIENT: no<a href="#section-7.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acme-delegated-certificates">
<section id="section-7.4">
        <h3 id="name-acme-delegated-certificates">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-acme-delegated-certificates" class="section-name selfRef">ACME Delegated Certificates</a>
        </h3>
<p id="section-7.4-1">ACME Delegated Certificates <span>[<a href="#RFC9115" class="cite xref">RFC9115</a>]</span> allows the CPE to use a vendor-
operated service to obtain a CA-signed ACME delegated certificate. It allows
the CPE to request from a service managing the CPE, acting as a
profiled ACME server, a certificate for a delegated identity,
i.e., one belonging to the CPE. The CPE then uses the ACME protocol (with the
extensions described in <span>[<a href="#RFC8739" class="cite xref">RFC8739</a>]</span>) to request issuance of a short-term,
Automatically Renewed (STAR) certificate for the same delegated identity.
The generated short-term certificate is automatically renewed by the public CA,
is periodically fetched by the CPE.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">R-REDUCE-CA: No<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">R-ELIMINATE-CA: No<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4">ACME delegated certificates do not require changes to client authentication libraries or operation.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<p id="section-7.4-5">R-SUPPORT-CA: Unknown<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<p id="section-7.4-6">R-SUPPORT-CLIENT: yes<a href="#section-7.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="raw-public-keys">
<section id="section-7.5">
        <h3 id="name-raw-public-keys">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-raw-public-keys" class="section-name selfRef">Raw Public Keys</a>
        </h3>
<p id="section-7.5-1">Raw public keys (RPK) <span>[<a href="#RFC7250" class="cite xref">RFC7250</a>]</span> can be authenticated out-of-band or using trust on first use (TOFU).
For a small network, this can be more appealing than a local or remote Certification Authority signing
keys and dealing with certificate renewal.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">R-REDUCE-CA: yes<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">R-ELIMINATE-CA: yes<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<p id="section-7.5-4">RPKs have been supported by OpenSSL and wolfSSL since 2023
and by GnuTLS since 2019. However, RPKs are not supported
by browsers or by curl.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
<p id="section-7.5-5">R-SUPPORT-CA: n/a, this system does not use Certification Authorities at all.<a href="#section-7.5-5" class="pilcrow">¶</a></p>
<p id="section-7.5-6">R-SUPPORT-CLIENT: Some; all major libraries support RPK, but clients (browsers and curl) do not support RPK.
Further, DNR and DDR in verified discovery mode expect to encounter certificates and do not support RPK.<a href="#section-7.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="self-signed-certificate">
<section id="section-7.6">
        <h3 id="name-self-signed-certificate">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-self-signed-certificate" class="section-name selfRef">Self-signed Certificate</a>
        </h3>
<p id="section-7.6-1">A self-signed certificate requires the client to authorize the connection, which is usually
a "click OK to continue" dialog box and is a trust on first use (TOFU) solution.  While it is
possible the user verifies the certificate matches expectations, this seldom occurs. The
certificate warnings are normalized by users which weakens security overall.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">R-REDUCE-CA: yes, public CA's are not used at all.<a href="#section-7.6-2" class="pilcrow">¶</a></p>
<p id="section-7.6-3">R-ELIMINATE-CA: yes<a href="#section-7.6-3" class="pilcrow">¶</a></p>
<p id="section-7.6-4">Existing clients support self-signed certificates fairly well, but the
user experience with clients is poor: some clients can't remember to
trust a certificate and clicking through certificate warnings will
become normalized.<a href="#section-7.6-4" class="pilcrow">¶</a></p>
<p id="section-7.6-5">Modifying self-signed certificate handling for ".local" <span>[<a href="#RFC6761" class="cite xref">RFC6761</a>]</span>
or ".internal" <span>[<a href="#I-D.davies-internal-tld" class="cite xref">I-D.davies-internal-tld</a>]</span> might be worth further
study.<a href="#section-7.6-5" class="pilcrow">¶</a></p>
<p id="section-7.6-6">R-SUPPORT-CA: n/a, this system does not use Certification Authories at all.<a href="#section-7.6-6" class="pilcrow">¶</a></p>
<p id="section-7.6-7">R-SUPPORT-CLIENT: Yes, but poor user experience.<a href="#section-7.6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="local-ca-certification-authority-built-into-cpe">
<section id="section-7.7">
        <h3 id="name-local-ca-certification-auth">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-local-ca-certification-auth" class="section-name selfRef">Local CA: Certification Authority Built Into CPE</a>
        </h3>
<p id="section-7.7-1">The CPE would be a CA capable of signing certificates for other in-home
devices. The CA in the CPE would be limitied to signing only certificates belonging to
that home network (using Sections <a href="#delegated" class="auto internal xref">7.2</a> or <a href="#name-constraints" class="auto internal xref">7.3</a>).
This allows the CPE to sign certificates for other devices within the network such as
printers, IoT devices, NAS devices, laptops, or anything else needing to be a server
on the local network.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.7-2.1">
            <p id="section-7.7-2.1.1">This feature is beyond the scope of the ADD working group but is
mentioned because it was suggested during an ADD meeting.<a href="#section-7.7-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.7-3">R-REDUCE-CA: yes, it reduces interaction with public CAs but has same
number of interactions with the CPE operator's CA for the
CPE itself.  For other devices within the home network (e.g., printers), it
eliminates interaction with the vendor's CA.<a href="#section-7.7-3" class="pilcrow">¶</a></p>
<p id="section-7.7-4">R-ELIMINATE-CA: no<a href="#section-7.7-4" class="pilcrow">¶</a></p>
<p id="section-7.7-5">While technically the industry could build such a system, building such a system
across the ecosystem of client operating systems would be a daunting task.<a href="#section-7.7-5" class="pilcrow">¶</a></p>
<p id="section-7.7-6">R-SUPPORT-CA: yes<a href="#section-7.7-6" class="pilcrow">¶</a></p>
<p id="section-7.7-7">R-SUPPORT-CLIENT: yes<a href="#section-7.7-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">DNR-related security considerations are discussed in
   <span><a href="https://rfc-editor.org/rfc/rfc9463#section-7" class="relref">Section 7</a> of [<a href="#RFC9463" class="cite xref">RFC9463</a>]</span>.  Likewise, DDR-related security considerations
   are discussed in <span><a href="https://rfc-editor.org/rfc/rfc9462#section-7" class="relref">Section 7</a> of [<a href="#RFC9462" class="cite xref">RFC9462</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The communication between the CPE and endpoints is encrypted using mechanisms such as WPA2/3,
   and any communication with the DNS server co-located on the CPE is also protected.
   However, the client does not know whether the DNS server is co-located on the CPE or not.
   If the client uses clear text DNS (i.e., Do53), it will assume that the DNS messages are susceptible to
   pervasive monitoring. For instance, in an Enterprise deployment, multiple network devices
   could exist between an endpoint and the CPE;  hosting an encrypted DNS server on
   the CPE minimizes the impact of a breach, which is an essential zero trust principle. Furthermore,
   the client and user would be able to identify the entity hosting the encrypted DNS server
   using the ADN assigned to it.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC9462">[RFC9462]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Kinnear, E.</span>, <span class="refAuthor">Wood, C. A.</span>, <span class="refAuthor">McManus, P.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"Discovery of Designated Resolvers"</span>, <span class="seriesInfo">RFC 9462</span>, <span class="seriesInfo">DOI 10.17487/RFC9462</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9462">https://www.rfc-editor.org/rfc/rfc9462</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9463">[RFC9463]</dt>
      <dd>
<span class="refAuthor">Boucadair, M., Ed.</span>, <span class="refAuthor">Reddy.K, T., Ed.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Cook, N.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"DHCP and Router Advertisement Options for the Discovery of Network-designated Resolvers (DNR)"</span>, <span class="seriesInfo">RFC 9463</span>, <span class="seriesInfo">DOI 10.17487/RFC9463</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9463">https://www.rfc-editor.org/rfc/rfc9463</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="https-local-dom">[https-local-dom]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refTitle">"HTTPS for Local Domains"</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://docs.google.com/document/d/170rFC91jqvpFrKIqG4K8Vox8AL4LeQXzfikBQXYPmzU">https://docs.google.com/document/d/170rFC91jqvpFrKIqG4K8Vox8AL4LeQXzfikBQXYPmzU</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.davies-internal-tld">[I-D.davies-internal-tld]</dt>
        <dd>
<span class="refAuthor">Davies, K.</span> and <span class="refAuthor">A. McConachie</span>, <span class="refTitle">"A Top-level Domain for Private Use"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-davies-internal-tld-00</span>, <time datetime="2024-08-02" class="refDate">2 August 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-davies-internal-tld-00">https://datatracker.ietf.org/doc/html/draft-davies-internal-tld-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.reddy-add-delegated-credentials">[I-D.reddy-add-delegated-credentials]</dt>
        <dd>
<span class="refAuthor">Reddy.K, T.</span>, <span class="refAuthor">Boucadair, M.</span>, <span class="refAuthor">Wing, D.</span>, and <span class="refAuthor">S. Jain</span>, <span class="refTitle">"Delegated Credentials to Host Encrypted DNS Forwarders on CPEs"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-reddy-add-delegated-credentials-03</span>, <time datetime="2023-12-01" class="refDate">1 December 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-reddy-add-delegated-credentials-03">https://datatracker.ietf.org/doc/html/draft-reddy-add-delegated-credentials-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="openwrt">[openwrt]</dt>
        <dd>
<span class="refAuthor">OpenWrt</span>, <span class="refTitle">"OpenWrt Project"</span>, <span>&lt;<a href="https://openwrt.org/">https://openwrt.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PKIX-EST">[PKIX-EST]</dt>
        <dd>
<span class="refAuthor">Pritikin, M., Ed.</span>, <span class="refAuthor">Yee, P., Ed.</span>, and <span class="refAuthor">D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7030">https://www.rfc-editor.org/rfc/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="prpl">[prpl]</dt>
        <dd>
<span class="refAuthor">Prpl Foundation</span>, <span class="refTitle">"Prpl Foundation"</span>, <span>&lt;<a href="https://prplfoundation.org/">https://prplfoundation.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="prplwrt">[prplwrt]</dt>
        <dd>
<span class="refAuthor">Prpl Foundation</span>, <span class="refTitle">"Prpl WRT"</span>, <span>&lt;<a href="https://prplfoundation.org/project/prplwrt/">https://prplfoundation.org/project/prplwrt/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1918">[RFC1918]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y.</span>, <span class="refAuthor">Moskowitz, B.</span>, <span class="refAuthor">Karrenberg, D.</span>, <span class="refAuthor">de Groot, G. J.</span>, and <span class="refAuthor">E. Lear</span>, <span class="refTitle">"Address Allocation for Private Internets"</span>, <span class="seriesInfo">BCP 5</span>, <span class="seriesInfo">RFC 1918</span>, <span class="seriesInfo">DOI 10.17487/RFC1918</span>, <time datetime="1996-02" class="refDate">February 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1918">https://www.rfc-editor.org/rfc/rfc1918</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4192">[RFC4192]</dt>
        <dd>
<span class="refAuthor">Baker, F.</span>, <span class="refAuthor">Lear, E.</span>, and <span class="refAuthor">R. Droms</span>, <span class="refTitle">"Procedures for Renumbering an IPv6 Network without a Flag Day"</span>, <span class="seriesInfo">RFC 4192</span>, <span class="seriesInfo">DOI 10.17487/RFC4192</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4192">https://www.rfc-editor.org/rfc/rfc4192</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5625">[RFC5625]</dt>
        <dd>
<span class="refAuthor">Bellis, R.</span>, <span class="refTitle">"DNS Proxy Implementation Guidelines"</span>, <span class="seriesInfo">BCP 152</span>, <span class="seriesInfo">RFC 5625</span>, <span class="seriesInfo">DOI 10.17487/RFC5625</span>, <time datetime="2009-08" class="refDate">August 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5625">https://www.rfc-editor.org/rfc/rfc5625</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6598">[RFC6598]</dt>
        <dd>
<span class="refAuthor">Weil, J.</span>, <span class="refAuthor">Kuarsingh, V.</span>, <span class="refAuthor">Donley, C.</span>, <span class="refAuthor">Liljenstolpe, C.</span>, and <span class="refAuthor">M. Azinger</span>, <span class="refTitle">"IANA-Reserved IPv4 Prefix for Shared Address Space"</span>, <span class="seriesInfo">BCP 153</span>, <span class="seriesInfo">RFC 6598</span>, <span class="seriesInfo">DOI 10.17487/RFC6598</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6598">https://www.rfc-editor.org/rfc/rfc6598</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6761">[RFC6761]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Special-Use Domain Names"</span>, <span class="seriesInfo">RFC 6761</span>, <span class="seriesInfo">DOI 10.17487/RFC6761</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6761">https://www.rfc-editor.org/rfc/rfc6761</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6762">https://www.rfc-editor.org/rfc/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6890">[RFC6890]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Vegoda, L.</span>, <span class="refAuthor">Bonica, R., Ed.</span>, and <span class="refAuthor">B. Haberman</span>, <span class="refTitle">"Special-Purpose IP Address Registries"</span>, <span class="seriesInfo">BCP 153</span>, <span class="seriesInfo">RFC 6890</span>, <span class="seriesInfo">DOI 10.17487/RFC6890</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6890">https://www.rfc-editor.org/rfc/rfc6890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7250">https://www.rfc-editor.org/rfc/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7858">https://www.rfc-editor.org/rfc/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8190">[RFC8190]</dt>
        <dd>
<span class="refAuthor">Bonica, R.</span>, <span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Haberman, B.</span>, and <span class="refAuthor">L. Vegoda</span>, <span class="refTitle">"Updates to the Special-Purpose IP Address Registries"</span>, <span class="seriesInfo">BCP 153</span>, <span class="seriesInfo">RFC 8190</span>, <span class="seriesInfo">DOI 10.17487/RFC8190</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8190">https://www.rfc-editor.org/rfc/rfc8190</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8484">https://www.rfc-editor.org/rfc/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8520">[RFC8520]</dt>
        <dd>
<span class="refAuthor">Lear, E.</span>, <span class="refAuthor">Droms, R.</span>, and <span class="refAuthor">D. Romascanu</span>, <span class="refTitle">"Manufacturer Usage Description Specification"</span>, <span class="seriesInfo">RFC 8520</span>, <span class="seriesInfo">DOI 10.17487/RFC8520</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8520">https://www.rfc-editor.org/rfc/rfc8520</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8555">https://www.rfc-editor.org/rfc/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8585">[RFC8585]</dt>
        <dd>
<span class="refAuthor">Palet Martinez, J.</span>, <span class="refAuthor">Liu, H. M.-H.</span>, and <span class="refAuthor">M. Kawashima</span>, <span class="refTitle">"Requirements for IPv6 Customer Edge Routers to Support IPv4-as-a-Service"</span>, <span class="seriesInfo">RFC 8585</span>, <span class="seriesInfo">DOI 10.17487/RFC8585</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8585">https://www.rfc-editor.org/rfc/rfc8585</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8739">[RFC8739]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Lopez, D.</span>, <span class="refAuthor">Gonzalez de Dios, O.</span>, <span class="refAuthor">Pastor Perales, A.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Support for Short-Term, Automatically Renewed (STAR) Certificates in the Automated Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8739</span>, <span class="seriesInfo">DOI 10.17487/RFC8739</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8739">https://www.rfc-editor.org/rfc/rfc8739</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9115">[RFC9115]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">López, D.</span>, <span class="refAuthor">Pastor Perales, A.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"An Automatic Certificate Management Environment (ACME) Profile for Generating Delegated Certificates"</span>, <span class="seriesInfo">RFC 9115</span>, <span class="seriesInfo">DOI 10.17487/RFC9115</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9115">https://www.rfc-editor.org/rfc/rfc9115</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9250">[RFC9250]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Dickinson, S.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"DNS over Dedicated QUIC Connections"</span>, <span class="seriesInfo">RFC 9250</span>, <span class="seriesInfo">DOI 10.17487/RFC9250</span>, <time datetime="2022-05" class="refDate">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9250">https://www.rfc-editor.org/rfc/rfc9250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9345">[RFC9345]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Iyengar, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Delegated Credentials for TLS and DTLS"</span>, <span class="seriesInfo">RFC 9345</span>, <span class="seriesInfo">DOI 10.17487/RFC9345</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9345">https://www.rfc-editor.org/rfc/rfc9345</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9499">[RFC9499]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 9499</span>, <span class="seriesInfo">DOI 10.17487/RFC9499</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9499">https://www.rfc-editor.org/rfc/rfc9499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TR-069">[TR-069]</dt>
      <dd>
<span class="refAuthor">The Broadband Forum</span>, <span class="refTitle">"CPE WAN Management Protocol"</span>, <time datetime="2018-12" class="refDate">December 2018</time>, <span>&lt;<a href="https://www.broadband-forum.org/technical/download/TR-069.pdf">https://www.broadband-forum.org/technical/download/TR-069.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="example-of-delegated-certificate-issuance">
<section id="appendix-A">
      <h2 id="name-example-of-delegated-certif">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-example-of-delegated-certif" class="section-name selfRef">Example of Delegated Certificate Issuance</a>
      </h2>
<p id="appendix-A-1">Let's consider that the encrypted DNS forwarder is hosted on a CPE and provisioned by a
   service (e.g., ACS) in the operator's network. Also, let's assume that each CPE is assigned
   a unique FQDN (e.g., "cpe-12345.example.com" where 12345 is a unique
   number).<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1">It is best to ensure that such an FQDN does not carry any
   Personally Identifiable Information (PII) or device identification
   details like the customer number or device's serial number.<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-3">The CPE generates a public and private key-pair, builds a certificate signing
   request (CSR), and sends the CSR to a service in the operator
   managing the CPE.  Upon receipt of the CSR, the operator's service
   can utilize certificate management protocols like ACME <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span> to automate
   certificate management functions such as domain validation procedure,
   certificate issuance, and certificate revocation.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">The challenge with this technique is that the service will have to
   communicate with the CA to issue certificates for millions of CPEs.
   If an external CA is unable to issue a certificate in time or replace
   an expired certificate, the service would no longer be able to
   present a valid certificate to a CPE.  When the service requests
   certificate issuance for a large number of subdomains (e.g., millions
   of CPEs), it may be treated as an attacker by the CA to overwhelm it.
   Furthermore, the short-lived certificates (e.g., certificates that
   expire after 90 days) issued by the CA will have to be renewed
   frequently.  With short-lived certificates, there is a smaller time
   window to renew a certificate and, therefore, a higher risk that a CA
   outage will negatively affect the uptime of the encrypted DNS
   forwarders on CPEs (and the services offered via these CPEs).<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<p id="appendix-A-5">These challenges can be addressed by using protocols like
   ACME to automate the certificate renewal process, ensuring certificates
   are renewed well before expiration. Additionally, incorporating another
   CA as a backup can provide redundancy and further mitigate the risk of
   outages. By having a secondary CA, the service can switch to the backup
   CA in case the primary CA is unavailable, thus maintaining continuous
   service availability and reducing the risk of service disruption.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<p id="appendix-A-6">It offers the additional advantage of improving the security of
   Browser and CPE interactions. This ensures that HTTPS access to
   the CPE is possible, allowing the device administrator to securely
   communicate with and manage the CPE.<a href="#appendix-A-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This draft is triggered by the discussion that occured at IETF#119 (Brisbane)
about the need to frame the problem to be solved. Thanks to all the
participants to that discussion.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="appendix-B-2">
        <dt id="appendix-B-2.1">Acknowledgements from <span>[<a href="#I-D.reddy-add-delegated-credentials" class="cite xref">I-D.reddy-add-delegated-credentials</a>]</span>:</dt>
        <dd style="margin-left: 1.5em" id="appendix-B-2.2">
          <p id="appendix-B-2.2.1">Thanks to Neil Cook, Martin Thomson, Tommy Pauly, Benjamin Schwartz,
   and Michael Richardson for the discussion and comments.<a href="#appendix-B-2.2.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> </div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mohamed Boucadair</span></div>
<div dir="auto" class="left"><span class="org">Orange</span></div>
<div dir="auto" class="left">
<span class="postal-code">35000</span> <span class="locality">Rennes</span>
</div>
<div dir="auto" class="left"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mohamed.boucadair@orange.com" class="email">mohamed.boucadair@orange.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dan Wing</span></div>
<div dir="auto" class="left"><span class="org">Cloud Software Group Holdings, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:danwing@gmail.com" class="email">danwing@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
